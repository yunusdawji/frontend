/* Video Plugin */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){var t=e.summernote.renderer.getTemplate(),o=e.summernote.core.range,r=e.summernote.core.dom,i=function(t){var o,r=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,i=t.match(r),a=/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/,n=t.match(a),d=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/,l=t.match(d),s=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/,c=t.match(s),m=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,u=t.match(m),f=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/,v=t.match(f),h=/^.+.(mp4|m4v)$/,b=t.match(h),g=/^.+.(ogg|ogv)$/,w=t.match(g),p=/^.+.(webm)$/,y=t.match(p);if(i&&11===i[1].length){var V=i[1];o=e("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+V).attr("width","640").attr("height","360")}else if(n&&n[0].length)o=e("<iframe>").attr("frameborder",0).attr("src",n[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(l&&l[0].length)o=e("<iframe>").attr("frameborder",0).attr("src",l[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(c&&c[3].length)o=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+c[3]).attr("width","640").attr("height","360");else if(u&&u[2].length)o=e("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+u[2]).attr("width","640").attr("height","360");else if(v&&v[1].length)o=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+v[1]);else{if(!(b||w||y))return!1;o=e("<video controls>").attr("src",t).attr("width","640").attr("height","360")}return o[0]},a=function(e){e.focus();var t=o.create();if(t.isOnAnchor()){var i=r.ancestor(t.sc,r.isAnchor);t=o.createFromNode(i)}return t.toString()},n=function(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)},d=function(t,o,r){return e.Deferred(function(e){var t=o.find(".note-video-dialog"),i=t.find(".note-video-url"),a=t.find(".note-video-btn");t.one("shown.bs.modal",function(){i.val(r).on("input",function(){n(a,i.val())}).trigger("focus"),a.click(function(o){o.preventDefault(),e.resolve(i.val()),t.modal("hide")})}).one("hidden.bs.modal",function(){i.off("input"),a.off("click"),"pending"===e.state()&&e.reject()}).modal("show")})};e.summernote.addPlugin({name:"video",buttons:{video:function(e,o){return t.iconButton(o.iconPrefix+"youtube-play",{event:"showVideoDialog",title:e.video.video,hide:!0})}},dialogs:{video:function(e){var o='<div class="form-group row-fluid"><label>'+e.video.url+' <small class="text-muted">'+e.video.providers+'</small></label><input class="note-video-url form-control span12" type="text" /></div>',r='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+e.video.insert+"</button>";return t.dialog("note-video-dialog",e.video.insert,o,r)}},events:{showVideoDialog:function(e,t,o){var r=o.dialog(),n=o.editable(),l=a(n);t.saveRange(n),d(n,r,l).then(function(e){t.restoreRange(n);var o=i(e);o&&t.insertNode(n,o)}).fail(function(){t.restoreRange(n)})}},langs:{"en-US":{video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"}},"tr-TR":{video:{video:"Video",videoLink:"Video bağlantısı",insert:"Video ekle",url:"Video bağlantısı?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion veya Youku)"}}}})});